---
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(foreign)
library(dplyr)
library(ggplot2)
library(readxl)
library(treemap)
library(ggiraphExtra)
library(tibble)
library(maps)
library(mapproj)
library(ggmap)
library(stringr)
library(grid)
library(leaflet)
library(KoNLP)
library(rJava)
library(moments)
library(Hmisc)
library(prettyR)
library(MASS)
library(gmodels)
googleAPIkey<-"AIzaSyD548iSahGuxgvGqfg8P0ytIVF6ksn4NMw"  
register_google(googleAPIkey)

setwd("C:/Rstudy/work_R")

```



# 1. 전국 전기차 충전소 표준 데이터 가져오기 
 -> 저는 필요한 컬럼을 사용하는데 데이터를 정제할 필요가 없다 생각하여 데이터를 로드한 후 바로 사용하였습니다. 

```{r cars}
ec_car <- read.csv("5_car.csv")
```


# 2. 1에서 정제한 데이터를 구글맵 지도에 표시하시오 

### 2-1) 구글맵 활용 

```{r,warning= F}
se_map <- get_googlemap("Seoul", maptype = "roadmap" , zoom=11)

ggmap(se_map) +
  geom_point(data = ec_car, aes( x = 경도, y = 위도, label = 충전소명), colour = "blue", size = 3)
```


### 2-2) leaflet 활용
```{r,warning= F}
leaflet(ec_car) %>% setView(lng = 126.9230235, lat = 37.5578176, zoom =10)%>% 
  addProviderTiles('Esri.WorldTopoMap') %>% 
  addCircles(lng = ec_car$경도, lat = ec_car$위도, dashArray = 'blue', color = 'blue', radius = 100,
             label = ec_car$충전소명) 
```

### 2-3) leaflet 활용 2
```{r, warning= F}
leaflet(ec_car) %>% 
  setView(lng = 127.7143303, lat = 36.1824482, zoom =7)%>% 
  addProviderTiles('Esri.WorldTopoMap') %>% 
    addTiles() %>% addMarkers(lng = ec_car$경도, ec_car$위도,  
                             clusterOptions = markerClusterOptions(),
    popup =  paste("<b>충전소 명 :</b> ", ec_car$충전소명, "<br>"))

```




# 3.사원들의 판매실적 향상을 위해 어떤 교육이 더 효율적인지 분석하세요 

###  데이터 로드및 리코딩 
```{r}
data <- read.csv("5_sales_method.csv")


#코딩변경
data$method2[data$method == 1]<-"집체교육"
data$method2[data$method == 2]<-"멘토링 교육"
```


### 1) 교육 방법별로 교육을 이수한 사람들의 빈도수와 판매실적 평균값을 구하시오 
#### 교육방법별 교육을 이수한 사람들의 빈도수
```{r}
table(data$method2)

```



#### 판매실적 평균값 
```{r}
mean(data$performance)
t.test(data = data, performance ~ method2, var.equal = T)
```



### 2) 실제 판매 실적 비교 대상자 만의 데이터를 별도로 추출하세요 
#### -입사 6개월 이내 인력은 판매 실적 조사에서 제외함 -> 9999로 표기 
```{r}
data2 <- data %>%  filter(performance != 9999)
t.test(data = data2, performance ~ method2, var.equal = T)

```
평균값을 통해 필터링 된 데이터 확인 





### 3) 두 교육 방법별 판매실적 데이터 간에 분포 모양이 비슷한지를 검증하세요 
```{r}

data_1 <- data2 %>% filter(method2 == "집체교육")
data_2 <- data2 %>% filter(method2 == "멘토링 교육")
boxplot(data_1$performance, data_2$performance)
var.test(data_1$performance,data_2$performance) 

```
test 결과, p_value 가 0.05이상이기 때문에 동질성 분포도를 띈다. 따라서 
데이터간의 관계파악을 위해 t.test() 검정 을 실시한다. 







### 4) 두 집단 간의 판매실적에 차이가 있는지 검증하세요 

```{r}
t.test(data = data2, performance ~ method2, var.equal = T)

```

t.test 결과로 p_value가 0.05이하이기 때문에 두 집단간의 판매실적에 차이가 존재한다. 
